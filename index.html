<!DOCTYPE html>
<html>
	<head>
		<script>
			let pcs = {};
			
			const socket = new WebSocket('wss://add8j1ntf0.execute-api.ap-southeast-2.amazonaws.com/production');
			
			socket.addEventListener('open', (event) => {
				socket.send(JSON.stringify({
					action: 'join',
					meetingId: 'example'
				}));
			});
			
			socket.addEventListener('message', (event) => {
				let data = JSON.stringify(event.data);
				console.log(data);
				
				switch(data.action) {
					case 'broadcast':
						break
					case 'offer':
						break
					case 'answer':
						break
				}
				
				
				let pc = pcs[message.connectionId] = new RTCPeerConnection({
					iceServers: [
						{
							urls: 'stun:stun.l.google.com:19302'
						}
					]
				});
				
				pc.createOffer().then((offer) => {
					return pc.setLocalDescription(offer);
				}).then(() => {
					socket.send(JSON.stringify({
						action: 'offer',
						connectionId: message.connectionId,
						sdp: pc.localDescription
					}));
				});
			});
		</script>
	</head>
	<body>
	</body>
</html>
